/*! VolunteerRescue | (c) 2012 - 2018 SKRPC Holdings, Inc. 
 * http://volunteerrescue.org/app_license
 */
;var mePCV_fnPopup=function(b){var d=$("#mePCV_lstPopupCalloutRecipient");var a;var e;var c;a=$("<li>").append('<div style="display:table">').append($('<div style="display:table-row">').html('<span style="display:table-cell;padding-right:1em;">Status:</span><span>'+b.statusDescription+"</span>"));if(b.replyAt){a.append($('<div style="display:table-row">').html('<span style="display:table-cell;padding-right:1em;">Time/ETA:</span><span>'+b.replyAt+"</span>"))}if(b.textStatus){a.append($('<div style="display:table-row">').html('<span style="display:table-cell;padding-right:1em;">Text:</span><span>'+b.textStatus+"</span>"))}if(b.primaryStatus){a.append($('<div style="display:table-row">').html('<span style="display:table-cell;padding-right:1em;">Primary:</span><span>'+b.primaryStatus+"</span>"))}if(b.alternative1Status){a.append($('<div style="display:table-row">').html('<span style="display:table-cell;padding-right:1em;">Alt1:</span><span>'+b.alternative1Status+"</span>"))}if(b.alternative2Status){a.append($('<div style="display:table-row">').html('<span style="display:table-cell;padding-right:1em;">Alt2:</span><span>'+b.alternative2Status+"</span>"))}e="";if(b.callSign){e+="<li>Call sign: "+b.callSign+"</li>"}if(b.homePhone){if(b.phonePrimary=="2"){c=' data-theme="a" data-icon="star"'}else{c=""}e+="<li"+c+'><a href="tel:'+b.homePhone+'">Home: '+b.homePhone+"</a></li>"}if(b.cellPhone){if(b.phonePrimary=="1"){c=' data-theme="a" data-icon="star"'}else{c=""}e+="<li"+c+'><a href="tel:'+b.cellPhone+'">Cell: '+b.cellPhone+"</a></li>"}if(b.workPhone){if(b.phonePrimary=="3"){c=' data-theme="a" data-icon="star"'}else{c=""}e+="<li"+c+'><a href="tel:'+b.workPhone+'">Work: '+b.workPhone+"</a></li>"}if(b.email){e+='<li><a href="mailto:'+b.email+'">E-mail: '+b.email+"</a></li>"}$(d).empty().append('<li data-role="list-divider"><div>'+b.name+"</div><div>"+b.memberStatus+"</div></li>").append(a).append(e).listview("refresh");$("#mePCV_popupMeCalloutRecipient").popup("open")};var mePCV_fnStanddownCallout=function(b){var a=$(this);volunteerRescue.confirmationDialog("Are you sure you want to "+(b.data.action=="update"?"update":"stand down")+" the phone callout ?",function(){$.extend(g_pageParams,{action:b.data.action});window.sessionStorage.setItem("mePCP_pageParams",JSON.stringify(g_pageParams));$.mobile.changePage(a.attr("href"))},function(){});return false};var mePCV_fnAbortCallout=function(){volunteerRescue.confirmationDialog("Are you sure you want to abort the phone callout ?",function(){volunteerRescue.callAPI(volunteerRescue.currentSite,"me_callout_update/"+g_pageParams.calloutId,"Aborting...",function(a){window.history.back()},null,null,{type:"PUT",data:{action:"abort"}})},function(){});return false};var mePCV_fnRefreshCallout=function(){volunteerRescue.callAPI(volunteerRescue.currentSite,"me_callout_progress/"+g_pageParams.calloutId,"Retrieving details...",function(f){var e=$("#mePCV_lstCalloutView");var b,a;$(e).empty();if(f.recipients.length==undefined){for(var d in f.recipients){for(var c in f.recipients[d]){a=$("<li>").text(f.recipients[d][c].name).attr("data-vr-index-i",d).attr("data-vr-index-j",c).attr("data-vr-digits",f.recipients[d][c].digits).on("click",function(){mePCV_fnPopup(f.recipients[$(this).attr("data-vr-index-i")][$(this).attr("data-vr-index-j")])});if(f.recipients[d][c].image!=""){a.append($("<img>").attr("class","ui-li-icon").attr("src",g_basePath+"images/"+f.recipients[d][c].image));a.append($("<span>").addClass("vr-listview-extras").css({"float":"right",width:"10%"}).text(f.recipients[d][c].replyAt));if(f.recipients[d][c].callSign){a.append($("<div>").addClass("vr-listview-extras").text(f.recipients[d][c].callSign))}if(f.recipients[d][c].reply){a.append($("<div>").addClass("vr-listview-extras").text(f.recipients[d][c].reply))}}else{a.append($("<img>").attr("class","ui-li-icon"))}$(e).append(a)}}}else{$(e).append("<li>There are no responses to the call out.</li>")}$(e).listview("refresh");b=$("<ul>",{"data-role":"listview"});if(f.options.length==undefined){b.append($("<li>").append($("<a>",{id:"mePCV_btnPanelAll",text:"Show all"}).on("click",function(){$("#mePCV_lstCalloutView li[data-vr-digits]").removeClass("ui-screen-hidden");$("#mePCV_lstCalloutView").listview("refresh");$("#mePCV_textFilter").css("display","none");$("#mePCV_leftPanel").panel("close")})));for(var d in f.options){b.append($("<li>").append($("<a>",{id:"mePCV_btnPanel"+f.options[d].number,text:f.options[d].tabDescription,"data-vr-number":f.options[d].number}).append($("<img>",{"class":"ui-li-icon",src:g_basePath+"images/"+f.options[d].image})).on("click",function(){$("#mePCV_lstCalloutView li[data-vr-digits="+$(this).attr("data-vr-number")+"]").removeClass("ui-screen-hidden");$("#mePCV_lstCalloutView li[data-vr-digits!="+$(this).attr("data-vr-number")+"]").addClass("ui-screen-hidden");$("#mePCV_lstCalloutView").listview("refresh");$("#mePCV_textFilter").html("Showing: "+$(this).text()).css("display","block");$("#mePCV_leftPanel").panel("close")})))}}b.append($("<li>").append($("<a>",{id:"mePCV_btnPanelClose","data-rel":"close",href:"#",text:"Close panel"}).on("click",function(){$("#mePCV_leftPanel").panel("close")}))).append($("<li>").append($("<a>",{id:"mePCV_btnPanelBack","data-rel":"back",href:"#",text:"Back to recent call outs"})));$("#mePCV_leftPanel").empty().append(b).enhanceWithin().trigger("updatelayout")})};$("#mePCV_page").on("pageshow",function(){vr_device.googleAnalytics();g_pageParams=JSON.parse(window.sessionStorage.getItem("mePCP_pageParams"));$("img#mePCV_online").attr("src",(g_onLine==true?g_basePath+"images/online.png":g_basePath+"images/offline.png"));if(g_pageParams.status==2){$("#mePCV_btnAbort").removeClass("ui-disabled")}else{$("#mePCV_btnAbort").addClass("ui-disabled")}$("#mePCV_hdrMeCalloutView").text(g_pageParams.subject);$("#mePCV_btnStanddown").off("click",mePCV_fnStanddownCallout).on("click",{action:"standdown"},mePCV_fnStanddownCallout);$("#mePCV_btnUpdate").off("click",mePCV_fnStanddownCallout).on("click",{action:"update"},mePCV_fnStanddownCallout);$("#mePCV_btnAbort").off("click",mePCV_fnAbortCallout).on("click",mePCV_fnAbortCallout);$("#mePCV_btnRefreshCalloutView").off("click",mePCV_fnRefreshCallout).on("click",mePCV_fnRefreshCallout).click()});