/*! VolunteerRescue | (c) 2012 - 2018 SKRPC Holdings, Inc. 
 * http://volunteerrescue.org/app_license
 */
;var kitLI_lists;var kitLI_description;var kitLI_setPageParamsHandler=function(){$.extend(g_pageParams,{itemOffset:$(this).attr("data-vr-offset")?$(this).attr("data-vr-offset"):-1});window.sessionStorage.setItem("kitL_pageParams",JSON.stringify(g_pageParams));$.mobile.changePage($(this).attr("href"));return false};var kitLI_lockUnlock=function(){if(kitLI_lists[g_pageParams.kitUUID].locked==true){$('[id^="kitLI_btn"], [id^="kitLI_item_qty"]').each(function(){$(this).prop("readonly",true)});$("#kitLI_btnLock").text("Unlock");$("#kitLI_btnResetQuantities").addClass("ui-disabled")}else{$('[id^="kitLI_btn"], [id^="kitLI_item_qty"]').each(function(){$(this).prop("readonly",false)});$("#kitLI_btnLock").text("Lock");$("#kitLI_btnResetQuantities").removeClass("ui-disabled")}};$("#kitLI_page").on("pageshow",function(){var a=$("#kitLI_lstItems");var c;var e;var b;var d;var f;vr_device.googleAnalytics();g_pageParams=JSON.parse(window.sessionStorage.getItem("kitL_pageParams"));kitLI_lists=vr_device.localStorage.getItem("kitLists");if(kitLI_lists){kitLI_lists=JSON.parse(kitLI_lists)}if(!kitLI_lists||!kitLI_lists[g_pageParams.kitUUID]){window.history.back()}kitLI_description=kitLI_lists[g_pageParams.kitUUID].description;$("#kitLI_pageTitle").text(kitLI_description);$("img#kitLI_online").attr("src",(g_onLine==true?g_basePath+"images/online.png":g_basePath+"images/offline.png"));$(a).empty();f=null;if(kitLI_lists[g_pageParams.kitUUID].items.length>0){for(c in kitLI_lists[g_pageParams.kitUUID].items){if(kitLI_lists[g_pageParams.kitUUID].items[c].locationStorage!=f){f=kitLI_lists[g_pageParams.kitUUID].items[c].locationStorage;$(a).append($("<li>",{"data-role":"list-divider","data-theme":"b",text:f}))}e=kitLI_lists[g_pageParams.kitUUID].items[c];b=$("<div>").css({"float":"left",width:"70%","white-space":"normal"}).append($("<div>").html(e.description));d=$("<div>").addClass("vr-listview-extras");if(e.value!=""){d.append($("<div>").html("Item value: "+Number(parseFloat(e.value.match(/^[^\d]*(\d+(?:\.(?:\d*))*)/)[1])).toFixed(2))).append($("<div>").attr("id","kitLI_totalValue_"+c).html("Total value: "+Number(parseFloat(e.value.match(/^[^\d]*(\d+(?:\.(?:\d*))*)/)[1])*kitLI_lists[g_pageParams.kitUUID].items[c].quantityInUse).toFixed(2)))}if(e.notes!=""){d.append($("<div>").html(e.notes.replace(/\n/g,"<br />")))}$(a).append($("<li>").append($("<a>").attr("href","#").click({index:c},function(g){if(kitLI_lists[g_pageParams.kitUUID].locked==false){kitLI_lists[g_pageParams.kitUUID].items[g.data.index].enabled=!kitLI_lists[g_pageParams.kitUUID].items[g.data.index].enabled;vr_device.localStorage.setItem("kitLists",JSON.stringify(kitLI_lists));$("img#kitLI_item_img"+g.data.index).attr("src",g_basePath+"images/"+(kitLI_lists[g_pageParams.kitUUID].items[g.data.index].enabled==true?"correct-16.png":"incorrect-16.png"))}}).append($("<img>").addClass("ui-li-icon").attr({id:"kitLI_item_img"+c,src:g_basePath+"images/"+(e.enabled==true?"correct-16.png":"incorrect-16.png")})).append($("<input>").attr({type:"number",min:0,size:5,id:"kitLI_item_qty"+c}).css({"float":"right","margin-right":"0.5em",width:"10%"}).val(kitLI_lists[g_pageParams.kitUUID].items[c].quantityInUse).click(function(){return false}).change({index:c},function(g){kitLI_lists[g_pageParams.kitUUID].items[g.data.index].quantityInUse=parseInt($(this).val());if(isNaN(kitLI_lists[g_pageParams.kitUUID].items[g.data.index].quantityInUse)){kitLI_lists[g_pageParams.kitUUID].items[g.data.index].quantityInUse=0}if(kitLI_lists[g_pageParams.kitUUID].items[g.data.index].value!=""&&!isNaN(kitLI_lists[g_pageParams.kitUUID].items[g.data.index].value)){$("#kitLI_totalValue_"+g.data.index).html("Total value: "+Number(parseFloat(kitLI_lists[g_pageParams.kitUUID].items[g.data.index].value.match(/^[^\d]*(\d+(?:\.(?:\d*))*)/)[1])*kitLI_lists[g_pageParams.kitUUID].items[g.data.index].quantityInUse).toFixed(2))}vr_device.localStorage.setItem("kitLists",JSON.stringify(kitLI_lists))})).append(b.append(d))).append($("<a>").attr("href","kit_list_item_edit.html").attr("data-vr-offset",c).click(kitLI_setPageParamsHandler)))}}else{$(a).append("<li>You have not added any items to the kit list.</li>")}$(a).listview("refresh");kitLI_lockUnlock()});$("#kitLI_btnAddListItem").click(kitLI_setPageParamsHandler);$("#kitLI_btnLock").click(function(){kitLI_lists[g_pageParams.kitUUID].locked=!kitLI_lists[g_pageParams.kitUUID].locked;vr_device.localStorage.setItem("kitLists",JSON.stringify(kitLI_lists));kitLI_lockUnlock()});$("#kitLI_btnResetQuantities").click(function(){if(kitLI_lists[g_pageParams.kitUUID].locked==false&&kitLI_lists[g_pageParams.kitUUID].items.length>0){for(var a in kitLI_lists[g_pageParams.kitUUID].items){kitLI_lists[g_pageParams.kitUUID].items[a].quantityInUse=kitLI_lists[g_pageParams.kitUUID].items[a].quantityRequired;kitLI_lists[g_pageParams.kitUUID].items[a].enabled=false;vr_device.localStorage.setItem("kitLists",JSON.stringify(kitLI_lists));$("input#kitLI_item_qty"+a).val(kitLI_lists[g_pageParams.kitUUID].items[a].quantityRequired);$("img#kitLI_item_img"+a).attr("src",g_basePath+"images/incorrect-16.png")}}});