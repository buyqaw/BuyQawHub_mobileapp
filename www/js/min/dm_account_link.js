/*! VolunteerRescue | (c) 2012 - 2018 SKRPC Holdings, Inc. 
 * http://volunteerrescue.org/app_license
 */
;var dmALK_registerClickHandler=function(){var accounts=vr_device.localStorage.getItem("vrAccounts");accounts=!accounts?{}:JSON.parse(accounts);if($("#dmALK_rdoTypePublic").prop("checked")==true){accounts[$("#dmALK_txtEmailAddress").val()]={description:$("#dmALK_txtDescription").val(),emailAddress:$("#dmALK_txtEmailAddress").val(),uuid:null,publicAccount:true};accounts=volunteerRescue.sortAssociative(accounts);vr_device.localStorage.setItem("vrAccounts",JSON.stringify(accounts));volunteerRescue.messageDialog("Registered","Successfully linked to the public account.",function(){window.history.back()})}else{$.mobile.loading("show",{text:"Registering account"});$.ajax({url:"https://volunteerrescue.org/api/app/register/confirm",type:"POST",data:{description:$("#dmALK_txtDescription").val(),emailAddress:$("#dmALK_txtEmailAddress").val(),registrationCode:$("#dmALK_txtRegisterCode").val()},async:true,cache:false,success:function(json){var apiResponse=eval(json);var errors="";$.mobile.loading("hide");if(apiResponse.result==true){accounts[apiResponse.emailAddress]={description:apiResponse.description,emailAddress:apiResponse.emailAddress,uuid:apiResponse.uuid,publicAccount:false};accounts=volunteerRescue.sortAssociative(accounts);vr_device.localStorage.setItem("vrAccounts",JSON.stringify(accounts));volunteerRescue.messageDialog("Registered","Successfully linked to the private account.",function(){window.history.back()})}else{for(i in apiResponse.errors){errors+="<li>"+apiResponse.errors[i]+"</li>"}volunteerRescue.messageDialog("Error","<p>The following error(s) occurred</p><ul>"+errors+"</ul>",null)}},error:function(){$.mobile.loading("hide");volunteerRescue.messageDialog("Error","Unable to link to the private account.",null)}})}};var dmALK_emailClickHandler=function(){$.mobile.loading("show",{text:"Sending e-mail"});$.ajax({url:"https://volunteerrescue.org/api/app/register/request",type:"POST",data:{description:$("#dmALK_txtDescription").val(),emailAddress:$("#dmALK_txtEmailAddress").val(),register:false},async:true,cache:false,success:function(json){var apiResponse=eval(json);var errors="";var i;$.mobile.loading("hide");if(apiResponse.result==true){volunteerRescue.messageDialog("E-mail sent","An e-mail has been sent to the e-mail address entered that contains a code for the Code field, if you do not receive the e-mail check your spam/junk folders.",null)}else{for(i in apiResponse.errors){errors+="<li>"+apiResponse.errors[i]+"</li>"}volunteerRescue.messageDialog("Error","<p>The following error(s) occurred</p><ul>"+errors+"</ul>",null)}},error:function(){$.mobile.loading("hide");volunteerRescue.messageDialog("Error","Unable to send e-mail to the e-mail address.",null)}})};$("#dmALK_page").on("pageshow",function(){vr_device.googleAnalytics();$("img#dmALK_online").attr("src",(g_onLine==true?g_basePath+"images/online.png":g_basePath+"images/offline.png"));$("#dmALK_txtDescription").val(null);$("#dmALK_txtEmailAddress").val(null);$("#dmALK_txtRegisterCode").val(null);$("#dmALK_registerForm").off("click",dmALK_registerClickHandler).on("click",dmALK_registerClickHandler);$("#dmALK_emailCode").off("click",dmALK_emailClickHandler).on("click",dmALK_emailClickHandler);$("#dmALK_form").submit(dmALK_registerClickHandler);$('[name="dmALK_rdoType"]').change(function(){$("#dmALK_divPrivate").css("display",$("#dmALK_rdoTypePrivate").prop("checked")==true?"block":"none")})});