/*! VolunteerRescue | (c) 2012 - 2018 SKRPC Holdings, Inc. 
 * http://volunteerrescue.org/app_license
 */
;var mePCS_originalPhoneMenu;var mePCS_saveClickHandler=function(b){var a=[];$('input[id^="mePCS_role-"]').each(function(){if($(this).prop("checked")){a[a.length]=$(this).attr("id").substr(11)}});volunteerRescue.callAPI(volunteerRescue.currentSite,"me_callout_start","Starting...",function(c){window.history.back()},null,null,{type:"PUT",data:{action:g_pageParams.op,subject:$("#mePCS_subject").val(),welcomeMessage:$("#mePCS_welcomeMessage").val(),voiceMessage:$("#mePCS_voiceMessage").val(),textMessage:$("#mePCS_textMessage").val(),callerId:$("#mePCS_callerId").val(),phoneMenu:$("#mePCS_phoneMenu").val(),voiceAsText:$("#mePCS_voiceAsText").prop("checked"),disablePhoneServices:$("#mePCS_disablePhoneServices").prop("checked"),recordCall:$("#mePCS_recordCall").prop("checked"),standdown:$("#mePCS_standdown").prop("checked"),roles:a.join(),eventCategory:$("#mePCS_eventCategory").val(),eventTaskNumber:$("#mePCS_eventTaskNumber").val()}});return false};$("#mePCS_page").on("pageshow",function(){vr_device.googleAnalytics();g_pageParams=JSON.parse(window.sessionStorage.getItem("mePCS_pageParams"));$("#mePCS_pageTitle").text(g_pageParams.op=="callout"?"Start call out":"Start conference call");$("img#mePCS_online").attr("src",(g_onLine==true?g_basePath+"images/online.png":g_basePath+"images/offline.png"));$("#mePCS_divWelcomeMessage, #mePCS_divTextMessage, #mePCS_divVoiceMessage, #mePCS_divCallerId, #mePCS_divVoiceAsText, #mePCS_divRecordCall, #mePCS_divDisablePhoneServices, #mePCS_divStanddown, #mePCS_divEvent").css("display","none");$("#mePCS_form").css("display","none");$("#mePCS_noRoles").css("display","none");volunteerRescue.callAPI(volunteerRescue.currentSite,"me_callout_start","Retrieving details...",function(b){var a;if(b.roles.length==0){$("#mePCS_form").css("display","none");$("#mePCS_noRoles").css("display","block")}else{$("#mePCS_form").css("display","block");$("#mePCS_noRoles").css("display","none");a=$("<fieldset>",{"data-role":"controlgroup"}).append($("<legend>",{text:"Select the roles to include:"}));$.each(b.roles,function(c,d){a.append($("<label/>",{"for":"mePCS_role-"+d.rid,text:d.name}));a.append($("<input/>",$.extend({id:"mePCS_role-"+d.rid,name:"mePCS_role-"+d.rid,type:"checkbox"},b.roles.length==1||d.autoSelect==true?{checked:"checked"}:{})))});$("#mePCS_divRoles").css("display","block");if(b.roles.length==1){$("#mePCS_role-"+b.roles[0].rid).attr("disabled","disabled")}$("#mePCS_divRoles").empty().append(a).enhanceWithin();volunteerRescue.populateFields(b,"mePCS_");$("#mePCS_divTemplate").css("display",b.templateList?"block":"none");if(g_pageParams.op=="callout"){$("#mePCS_divTextMessage, #mePCS_divStanddown").css("display","block");if($("#mePCS_eventCategory option").length>0){$("#mePCS_divEvent").css("display","block");$("#mePCS_eventCategory").selectmenu("refresh",true)}}if(b.callerId){$("#mePCS_divWelcomeMessage, #mePCS_divCallerId").css("display","block");if(g_pageParams.op=="callout"){$("#mePCS_divVoiceMessage, #mePCS_divVoiceAsText, #mePCS_divDisablePhoneServices").css("display","block")}else{$("#mePCS_divRecordCall").css("display","block")}$("#mePCS_callerId").selectmenu("refresh",true);$("#mePCS_voiceAsText").checkboxradio("refresh",true);$("#mePCS_disablePhoneServices").checkboxradio("refresh",true);$("#mePCS_recordCall").checkboxradio("refresh",true);if(!b.templateList){$("body").scrollTop($("#mePCS_welcomeMessage").offset().top)}}$("#mePCS_template").selectmenu("refresh",true);$("#mePCS_phoneMenu").selectmenu("refresh",true);$("#mePCS_standdown").checkboxradio("refresh",true);$("#mePCS_subject").focus();$("#mePCS_submitForm").off("click",mePCS_saveClickHandler).on("click",{apiResponse:b},mePCS_saveClickHandler);$("#mePCS_form").submit({apiResponse:b},mePCS_saveClickHandler);$("textarea[id=mePCS_voiceMessage]").keyup(function(){$('label[for="mePCS_voiceMessage"]').text("Voice message: ("+$(this).val().length+")")}).keyup();$("textarea[id=mePCS_textMessage]").keyup(function(){$('label[for="mePCS_textMessage"]').text("Text message: ("+$(this).val().length+")")}).keyup();$("input#mePCS_eventTaskNumber").change(function(){if($("select#mePCS_eventCategory").val()==-1){$("select#mePCS_eventCategory").val($('select#mePCS_eventCategory option[value!="-1"]:first').val());$("#mePCS_eventCategory").selectmenu("refresh",true)}});$("input#mePCS_voiceAsText").change(function(){$("#mePCS_divTextMessage").css("display",$(this).prop("checked")==true?"none":"block")}).change();$("input#mePCS_standdown").change(function(){if($(this).prop("checked")==true){mePCS_originalPhoneMenu=$("select#mePCS_phoneMenu").val();$("input#mePCS_voiceAsText").prop("checked",false).change();$("select#mePCS_phoneMenu").val(b.standdownCmid).selectmenu("refresh",true);$("textarea#mePCS_voiceMessage").val(b.standdownVoiceMessage).keyup();$("textarea#mePCS_textMessage").val(b.standdownTextMessage).keyup()}else{$("input#mePCS_voiceAsText").prop("checked",true).change();$("select#mePCS_phoneMenu").val(mePCS_originalPhoneMenu).selectmenu("refresh",true)}$("#mePCS_voiceAsText").checkboxradio("refresh",true)});$("#mePCS_template").change(function(){if($(this).val()!=-1){var c=b.templateList[$(this).val()];if(b.callerId){$("#mePCS_callerId").val(c.callerId?c.callerId:b.callerId.value)}$("#mePCS_welcomeMessage").val(c.welcomeMessage);$("#mePCS_voiceMessage").val(c.voiceMessage);$("#mePCS_textMessage").val(c.textMessage);$("#mePCS_phoneMenu").val(c.phoneMenu);$("#mePCS_eventCategory").val(c.eventCategory);$("#mePCS_voiceAsText").prop("checked",c.voiceAsText==1?true:false).change();$("#mePCS_disablePhoneServices").prop("checked",c.disablePhoneServices==1?true:false);$("#mePCS_recordCall").prop("checked",c.recordCall==1?true:false);$("#mePCS_standdown").prop("checked",c.standdown==1?true:false)}else{if(b.callerId){$("#mePCS_callerId").val(b.callerId.value);$("#mePCS_welcomeMessage").val(b.welcomeMessage.value);$("#mePCS_recordCall").prop("checked",b.recordCall.checked==1?true:false)}$("#mePCS_phoneMenu").val(b.phoneMenu.value);$("#mePCS_voiceMessage").val(null);$("#mePCS_textMessage").val(null);$("#mePCS_eventCategory").val(-1);$("#mePCS_voiceAsText").prop("checked",true).change();$("#mePCS_disablePhoneServices").prop("checked",false);$("#mePCS_standdown").prop("checked",false)}$("#mePCS_template").selectmenu("refresh",true);$("#mePCS_callerId").selectmenu("refresh",true);$("#mePCS_phoneMenu").selectmenu("refresh",true);$("#mePCS_voiceAsText").checkboxradio("refresh",true);$("#mePCS_disablePhoneServices").checkboxradio("refresh",true);$("#mePCS_recordCall").checkboxradio("refresh",true);$("#mePCS_standdown").checkboxradio("refresh",true)})}},null,null,{type:"GET",data:{action:g_pageParams.op}})});