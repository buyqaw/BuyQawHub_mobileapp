/*! VolunteerRescue | (c) 2012 - 2018 SKRPC Holdings, Inc. 
 * http://volunteerrescue.org/app_license
 */
;var meMBL_selectedRoleId=null;var meMBL_fnPopup=function(d){var c=$("#meMBL_lstPopupMemberDetails");var a;var b;a='<li data-role="list-divider" style="font-size:1em;"><div>'+d.name+"</div><div>"+d.status+"</div></li>";if(d.callSign){a+="<li>Call sign: "+d.callSign+"</li>"}if(d.homePhone){if(d.phonePrimary=="2"){b=' data-theme="a" data-icon="star"'}else{b=""}a+="<li"+b+'><a href="tel:'+d.homePhone+'">Home: '+d.homePhone+"</a></li>"}if(d.cellPhone){if(d.phonePrimary=="1"){b=' data-theme="a" data-icon="star"'}else{b=""}a+="<li"+b+'><a href="tel:'+d.cellPhone+'">Cell: '+d.cellPhone+"</a></li>"}if(d.workPhone){if(d.phonePrimary=="3"){b=' data-theme="a" data-icon="star"'}else{b=""}a+="<li"+b+'><a href="tel:'+d.workPhone+'">Work: '+d.workPhone+"</a></li>"}if(d.email){a+='<li><a href="mailto:'+d.email+'">E-mail: '+d.email+"</a></li>"}$(c).empty().append(a).listview("refresh");$("#meMBL_popupMeMemberDetails").popup("open")};$("#meMBL_page").on("pageshow",function(){vr_device.googleAnalytics();g_pageParams=JSON.parse(window.sessionStorage.getItem("meMBR_pageParams"));$("img#meMBL_online").attr("src",(g_onLine==true?g_basePath+"images/online.png":g_basePath+"images/offline.png"));$("#meMBL_filter").val("");$("#meMBL_textFilter").css("display","none");volunteerRescue.callAPI(volunteerRescue.currentSite,"me_member_list","Retrieving role members...",function(d){var e=$("#meMBL_lstMemberList");var a,b;var c;$(e).empty();for(c in d.memberList){a=$("<li>").text(d.memberList[c].name).attr("data-vr-index",c).attr("data-filtertext",d.memberList[c].name).attr("data-vr-roleIds",d.memberList[c].roleIds.replace(/,/g," ")).on("click",function(){meMBL_fnPopup(d.memberList[$(this).attr("data-vr-index")])});if(d.memberList[c].image!=""){a.append($("<img>").attr("class","ui-li-icon").attr("src",g_basePath+"images/"+d.memberList[c].image))}else{a.append($("<img>").attr("class","ui-li-icon"))}a.append($("<div>").addClass("vr-listview-extras").text(d.memberList[c].status));$(e).append(a)}$(e).filterable("option","filterCallback",function(g,f){if($(this).hasClass("ui-li-divider")){return false}if(meMBL_selectedRoleId!=null&&$(this).attr("data-vr-roleIds").match(new RegExp("(^|\\s)"+meMBL_selectedRoleId+"(\\s|$)"))==null){return true}return $(this).attr("data-filtertext").match(new RegExp(f,"i"))==null?true:false}).listview("refresh");b=$("<ul>",{"data-role":"listview"});if(d.roles.length==undefined){b.append($("<li>").append($("<a>",{id:"meMBL_btnPanelAll",text:"Show all"}).on("click",function(){meMBL_selectedRoleId=null;$("#meMBL_lstMemberList li[data-vr-roleIds]").removeClass("ui-screen-hidden");$("#meMBL_lstMemberList").listview("refresh");$("#meMBL_textFilter").css("display","none");$("#meMBL_leftPanel").panel("close");$("#meMBL_content").scrollTop(0)})));for(var c in d.roles){b.append($("<li>").append($("<a>",{id:"meMBL_btnPanel"+d.roles[c].roleId,text:d.roles[c].description,"data-vr-roleId":d.roles[c].roleId}).on("click",function(){meMBL_selectedRoleId=$(this).attr("data-vr-roleId");$("#meMBL_lstMemberList li[data-vr-roleIds]").addClass("ui-screen-hidden");$("#meMBL_lstMemberList li[data-vr-roleIds~="+meMBL_selectedRoleId+"]").removeClass("ui-screen-hidden");$("#meMBL_lstMemberList").listview("refresh");$("#meMBL_textFilter").html("Role: "+$(this).text()).css("display","block");$("#meMBL_leftPanel").panel("close");$("#meMBL_content").scrollTop(0)})))}}b.append($("<li>").append($("<a>",{id:"meMBL_btnPanelClose","data-rel":"close",href:"#",text:"Close panel"}).on("click",function(){$("#meMBL_leftPanel").panel("close")}))).append($("<li>").append($("<a>",{id:"meMBL_btnPanelBack","data-rel":"back",href:"#",text:"Back to dashboard"})));$("#meMBL_leftPanel").empty().append(b).enhanceWithin().trigger("updatelayout")})});