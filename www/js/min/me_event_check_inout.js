/*! VolunteerRescue | (c) 2012 - 2018 SKRPC Holdings, Inc. 
 * http://volunteerrescue.org/app_license
 */
;var meECIO_checkInOutConfirmationHandler=function(a){var b=new Date();$("#meECIO_checkInTime").val(volunteerRescue.zeroPad(b.getHours(),2)+":"+volunteerRescue.zeroPad(b.getMinutes(),2));$("[name=mwECIO_replaceInOut]").each(function(){$(this).text(a.data.checkIn==true?"in":"out")});if(a.data.checkIn==true){$("#meECIO_submitButton").removeClass("ui-btn-r").addClass("ui-btn-g")}else{$("#meECIO_submitButton").removeClass("ui-btn-g").addClass("ui-btn-r")}$("#meECIO_submitButton").off("click",meECIO_checkInOutHandler).on("click",$.extend(a.data,{element:$(a.srcElement||a.target)}),meECIO_checkInOutHandler);$("#meECIO_popupCheckOut").popup("open");return false};var meECIO_checkInOutHandler=function(a){$("#meECIO_popupCheckOut").popup("close");volunteerRescue.callAPI(volunteerRescue.currentSite,"me_event_check_inout/"+a.data.eventId,a.data.checkIn==true?"Checking in...":"Checking out...",function(b){volunteerRescue.messageDialog("Check in/out",a.data.checkIn==true?"You are checked in to the event":"You are checked out from the event",null);if(a.data.checkIn==true){$("[name=meECIO_checkedIn"+a.data.eventId+"]:last").append($("<div>").attr("name","meECIO_checkedIn"+a.data.eventId).css("margin-top","0.5em").append($("<div>").text("Checked in at: "+b.checkedIn)))}else{$("[name=meECIO_checkedIn"+a.data.eventId+"]:last").append($("<div>").text("Checked out at: "+b.checkedOut));if(b.duration!=null){$("[name=meECIO_checkedIn"+a.data.eventId+"]:last").append($("<div>").text("Duration: "+b.duration))}}if(a.data.checkIn==true){$(a.data.element).removeClass("ui-btn-g").addClass("ui-btn-r")}else{$(a.data.element).removeClass("ui-btn-r").addClass("ui-btn-g")}$(a.data.element).text(a.data.checkIn==true?"Check out":"Check in").off("click",meECIO_checkInOutConfirmationHandler).on("click",{eventId:a.data.eventId,checkIn:!a.data.checkIn,canCheckIn:true},meECIO_checkInOutConfirmationHandler)},function(c){var d="";for(var b in c.errors){d+="<li>"+c.errors[b]+"</li>"}volunteerRescue.messageDialog("Error","<p>The following errors occured</p><ul>"+d+"</ul>",null)},null,{type:"PUT",data:{checkIn:a.data.checkIn,time:$("#meECIO_checkInTime").val()}});return false};$("#meECIO_page").on("pageshow",function(){vr_device.googleAnalytics();$("img#meECIO_online").attr("src",(g_onLine==true?g_basePath+"images/online.png":g_basePath+"images/offline.png"));volunteerRescue.callAPI(volunteerRescue.currentSite,"me_event_check_inout","Retrieving events...",function(f){var e=$("#meECIO_lstEvent");var b,g,a;var d,c;$(e).empty();if(f.event.length>0){for(d in f.event){b=$("<li>").append("<div>");if(f.event[d].inProgress==true){b.append($("<div>").text("Started at: "+f.event[d].startAt))}else{b.append($("<div>").text("Starts at: "+f.event[d].startAt)).append($("<div>").text("Ends at: "+f.event[d].endAt))}for(c in f.event[d]["times"]){g=$("<div>").attr("name","meECIO_checkedIn"+f.event[d].eventId).css("margin-top","0.5em");if(f.event[d]["times"][c].checkedInAt!=null){g.append($("<div>").text("Checked in at: "+f.event[d]["times"][c].checkedInAt));if(f.event[d]["times"][c].checkedOutAt!=null){g.append($("<div>").text("Checked out at: "+f.event[d]["times"][c].checkedOutAt));a=true}else{a=false}if(f.event[d]["times"][c].duration!=null){g.append($("<div>").text("Duration: "+f.event[d]["times"][c].duration))}}b.append(g)}if(a==false){b.append($("<button>").attr({id:"meECIO_btnCheckInOut"+f.event[d].eventId,"data-mini":true,"data-theme":"r"}).text("Check out").click({eventId:f.event[d].eventId,checkIn:false,canCheckIn:f.event[d].canCheckIn},meECIO_checkInOutConfirmationHandler))}else{if(f.event[d].canCheckIn==true){b.append($("<button>").attr({id:"meECIO_btnCheckInOut"+f.event[d].eventId,"data-mini":true,"data-theme":"g"}).text("Check in").click({eventId:f.event[d].eventId,checkIn:true,canCheckIn:f.event[d].canCheckIn},meECIO_checkInOutConfirmationHandler))}}$(e).append($("<li>",{"data-role":"list-divider","data-theme":"b"}).text(f.event[d].title)).append(b)}}else{$(e).append("<li>There are no events available to check in to or check out from.</li>")}$(e).listview("refresh");$("#meECIO_page").trigger("create")})});